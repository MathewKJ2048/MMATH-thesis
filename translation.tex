%======================================================================
\chapter{Translation}
%======================================================================



%----------------------------------------------------------------------
\section{Translating Dash+ elements to TLA+}
%----------------------------------------------------------------------

A Dash+ model is written with Alloy expressions and code embedded inside Dash structures. The Dash structures are used to model a transition system. Since TLA+ supports transitions natively, the dash elements are translated directly to TLA+, without an intermediate Alloy step.


%----------------------------------------------------------------------
\subsection{States}
%----------------------------------------------------------------------

Each state is associated with a unique string in TLA+. The uniqueness of this string is guaranteed by using the fully qualified name of the state. No two states in a Dash model can have the same fully qualified name, so turning the fully qualified name into a string preserves uniqueness. These strings are associated with formulae in TLA+, and all further references to the state is made via the formula, rather than the string.

The set of all states and the set of all default states are assigned their own formulae, which are used later in the translation. The current state is modelled as a TLA+ VARIABLE, whose type depends on the Dash model. In the general case, the type is a set. For Dash models without concurrency, where the system cannot be in multiple states simultaneously, the type of the state VARIABLE is a string.

TODO: find out embedding code snippets and give examples

%----------------------------------------------------------------------
\subsection{Events}
%----------------------------------------------------------------------

This doesn't have an implementation yet, all examples are hand-translated as of now.

%----------------------------------------------------------------------
\subsection{Transitions}
%----------------------------------------------------------------------

Transitions are modelled as boolean formulae in TLA+. In Dash, the transitions are defined inside the state from which the transitions is taken. In the translation, all transitions are defined at the top-level. Each transition has the following:

\begin{itemize}
	\item (implicit) - the 'from' state, translated as state = \{from state\}
	\item goto - the 'to' state, translated as state' = \{to state\}
	\item when - the guard, translated as an Alloy expression
	\item do - the action, translated as an Alloy expression
	\item on - the triggering event
	\item (emitting event - todo: fill this up post discussion)
\end{itemize}

%----------------------------------------------------------------------
\subsection{Actions}
%----------------------------------------------------------------------

Alloy

%----------------------------------------------------------------------
\subsection{Guards}
%----------------------------------------------------------------------

Alloy

%----------------------------------------------------------------------
\subsection{Concurrency}
%----------------------------------------------------------------------

todo: discuss

%----------------------------------------------------------------------
\section{Translating Alloy elements to TLA+}
%----------------------------------------------------------------------

%----------------------------------------------------------------------
\subsection{Signatures}
%----------------------------------------------------------------------


%----------------------------------------------------------------------
\subsection{Fields}
%----------------------------------------------------------------------

%----------------------------------------------------------------------
\subsection{Multiplicities}
%----------------------------------------------------------------------

Explain the four multiplicities with two basic types, the use of quantifiers over cardinality as optimizations and set comprehension based composition

%----------------------------------------------------------------------
\subsection{Predicates}
%----------------------------------------------------------------------

%----------------------------------------------------------------------
\subsection{Facts}
%----------------------------------------------------------------------

%----------------------------------------------------------------------
\subsection{Commands}
%----------------------------------------------------------------------


%----------------------------------------------------------------------
\section{Translating LTL properties to TLA+ invariants}
%----------------------------------------------------------------------